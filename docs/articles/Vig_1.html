<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vignette_1 • CLCM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Vignette_1">
<meta property="og:description" content="CLCM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLCM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vig_1.html">Vignette_1</a>
    </li>
    <li>
      <a href="../articles/Vig_2.html">Vignette_2</a>
    </li>
    <li>
      <a href="../articles/Vig_3.html">Vignette_3</a>
    </li>
    <li>
      <a href="../articles/Vig_4.html">Vignette_4</a>
    </li>
    <li>
      <a href="../articles/Vig_5.html">Vignette_5</a>
    </li>
    <li>
      <a href="../articles/Vig_6.html">Vignette_6</a>
    </li>
    <li>
      <a href="../articles/Vig_7.html">Vignette_7</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Vig_1_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Vignette_1</h1>
            
      
      
      <div class="hidden name"><code>Vig_1.Rmd</code></div>

    </div>

    
    
<div id="overview-of-vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-vignettes" class="anchor"></a>Overview of Vignettes</h2>
<ol style="list-style-type: decimal">
<li><p>Introduction to the CLCM R package</p></li>
<li><p>C2 Fit Statistic</p></li>
<li><p>CLCM with more than 2 latent classes</p></li>
<li><p>CLCM with Multinomial Latent Regression (4 latent classes)</p></li>
<li><p>Longitudinal CLCM &amp; Transition Matrix</p></li>
<li><p>Longitudinal CLCM with Latent Regression (2 latent classes)</p></li>
<li><p>Longitudinal CLCM with Multinomial Latent Regression (4 latent classes)</p></li>
</ol>
</div>
<div id="introduction-to-clcm-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-to-clcm-r-package" class="anchor"></a>Introduction to CLCM R package</h2>
<p>This is an intro to the CLCM R package, which provides a variety of options for fitting confimatory latent class models to data types commonly occurring in clinical data. The novel methodological contribution to the field of statistics/psychometrics is the extension of models from Educational Measurement literature, which typically deals with binary data, to data distributions commonly encountered in clinical datasets.</p>
<p>This first or intro vignette will illustrate some of the capabilities of the package. Data will be simulated using K=1, or 1 factor. This will yield 2 latent classes. All 8 item types available will be simulated for this first example. Then a model will be fit to the data, and the AIC/BIC will be computed. Other vignettes will demonstrate the use of the C2 fit statistic and the transition matrix. The latter is used when data is longitudinal.</p>
</div>
<div id="specify-details-of-data-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#specify-details-of-data-generation" class="anchor"></a>Specify Details of Data Generation</h2>
<ol style="list-style-type: decimal">
<li>Specify the item.types (note that this implicitly specifies the number of items)</li>
<li>Specify how many categories in the items</li>
<li>If it’s a categorical/count item, specify number of categories - if it’s continuous (e.g., Normal or Beta distribution), just set to <code>NA</code>.</li>
<li>Specify the latent class proportions at each timepoint</li>
<li>Specify the Q-matrix</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CLCM</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'vctrs::data_frame' by 'tibble::data_frame'</span>
<span class="co">#&gt; when loading 'dplyr'</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="va">number.timepoints</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">item.type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ordinal'</span>, <span class="st">'Nominal'</span>, <span class="st">'Poisson'</span>, <span class="st">'Neg_Binom'</span>, <span class="st">'ZINB'</span>, <span class="st">'ZIP'</span>, <span class="st">'Normal'</span>, <span class="st">'Beta'</span><span class="op">)</span> 
<span class="va">sim.categories.j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>,  <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span> 
<span class="va">lc.prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Time_1'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, 
                <span class="st">'Time_2'</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">)</span>     
<span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">item.type</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, 
            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item_'</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">item.type</span><span class="op">)</span><span class="op">)</span>, <span class="st">'F1'</span><span class="op">)</span><span class="op">)</span>
<span class="va">Q</span>
<span class="co">#&gt;        F1</span>
<span class="co">#&gt; Item_1  1</span>
<span class="co">#&gt; Item_2  1</span>
<span class="co">#&gt; Item_3  1</span>
<span class="co">#&gt; Item_4  1</span>
<span class="co">#&gt; Item_5  1</span>
<span class="co">#&gt; Item_6  1</span>
<span class="co">#&gt; Item_7  1</span>
<span class="co">#&gt; Item_8  1</span></code></pre></div>
<p>Notice that the Q-matrix has 1 factor/attribute (K=1), which yields 2 latent classes. The simulation function has a default of 2 latent classes, so if you ignore the function call entirely, the function will create this Q-matrix automatically.</p>
</div>
<div id="simulate-item-responses" class="section level2">
<h2 class="hasAnchor">
<a href="#simulate-item-responses" class="anchor"></a>Simulate Item Responses</h2>
<p>Now we have what we need to pass to the function used to simulate the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">03102021</span><span class="op">)</span>
<span class="va">sim.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_clcm.html">simulate_clcm</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, Q <span class="op">=</span> <span class="va">Q</span>, number.timepoints <span class="op">=</span> <span class="va">number.timepoints</span>, 
                         item.type <span class="op">=</span> <span class="va">item.type</span>, 
                         categories.j <span class="op">=</span> <span class="va">sim.categories.j</span>, 
                         lc.prop <span class="op">=</span> <span class="va">lc.prop</span><span class="op">)</span></code></pre></div>
<p>This yields the simulated item responses. From here we can proceed to estimate the model.</p>
</div>
<div id="estimate-clcm" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-clcm" class="anchor"></a>Estimate CLCM</h2>
<p>Note the option <code>verbose = F</code> can be used to stop the function from printing estimation progress.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clcm.html">clcm</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">sim.dat</span><span class="op">$</span><span class="va">dat</span>, 
            item.type <span class="op">=</span> <span class="va">sim.dat</span><span class="op">$</span><span class="va">item.type</span>, 
            item.names <span class="op">=</span> <span class="va">sim.dat</span><span class="op">$</span><span class="va">item.names</span>, 
            Q <span class="op">=</span> <span class="va">sim.dat</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span> 
<span class="co">#&gt; iteration:  1   max diff in item parameter estimates:  3.417532 </span>
<span class="co">#&gt; iteration:  2   max diff in item parameter estimates:  1.984864 </span>
<span class="co">#&gt; iteration:  3   max diff in item parameter estimates:  0.145371 </span>
<span class="co">#&gt; iteration:  4   max diff in item parameter estimates:  0.001388 </span>
<span class="co">#&gt; iteration:  5   max diff in item parameter estimates:  0.000447 </span>
<span class="co">#&gt; iteration:  6   max diff in item parameter estimates:  0.000675 </span>
<span class="co">#&gt; iteration:  7   max diff in item parameter estimates:  0.000238 </span>
<span class="co">#&gt; iteration:  8   max diff in item parameter estimates:  0.000116 </span>
<span class="co">#&gt; iteration:  9   max diff in item parameter estimates:  0.000262 </span>
<span class="co">#&gt; iteration:  10   max diff in item parameter estimates:  6.3e-05</span></code></pre></div>
<p>This yields the estimated confirmatory latent class model.</p>
</div>
<div id="model-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fit" class="anchor"></a>Model Fit</h2>
<p>Next let’s exmaine model fit. Unfortunately, we cannot use the C2 statistic to evaluate absolute model fit due to the item types used here. The C2 statistic can only be used with all ordinal items. In this case, we can only compute the AIC/BIC. Of course, these are relative fit statistics so they aren’t very useful without a comparison. Regardless, we can compute it to illustrate that it is available.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/aic_bic_clcm.html">aic_bic_clcm</a></span><span class="op">(</span>mod <span class="op">=</span> <span class="va">mod</span><span class="op">)</span> 
<span class="co">#&gt; $neg_2LL</span>
<span class="co">#&gt; [1] 11639.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $npar</span>
<span class="co">#&gt; [1] 29</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $AIC</span>
<span class="co">#&gt; [1] 11697.06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $BIC</span>
<span class="co">#&gt; [1] 11819.28</span></code></pre></div>
</div>
<div id="classification-accuracy" class="section level2">
<h2 class="hasAnchor">
<a href="#classification-accuracy" class="anchor"></a>Classification Accuracy</h2>
<p>Next, let’s examine classification accuracy. We can compare the true latent class assignment (lca) with the estimated lca. This is performed next. Note that the model output contains the <code>true_lca</code> because the dataframe of simulated data (<code>sim.dat</code>) contained that variable.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lca.hat</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">dat</span><span class="op">$</span><span class="va">lca</span>
<span class="va">lca.true</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">dat</span><span class="op">$</span><span class="va">true_lca</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">lca.true</span> <span class="op">==</span> <span class="va">lca.hat</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; TRUE </span>
<span class="co">#&gt;    1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">lca.true</span> <span class="op">+</span> <span class="va">lca.hat</span><span class="op">)</span>
<span class="co">#&gt;         lca.hat</span>
<span class="co">#&gt; lca.true   1   2</span>
<span class="co">#&gt;        1 240   0</span>
<span class="co">#&gt;        2   0 260</span></code></pre></div>
<p>Looks pretty, preettty, prettttty good.</p>
</div>
<div id="plots" class="section level2">
<h2 class="hasAnchor">
<a href="#plots" class="anchor"></a>Plots</h2>
<p>Next let’s visualize how the item responses vary across the two latent classes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">dat.plot</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">dat</span>
<span class="va">dat.plot</span><span class="op">$</span><span class="va">lca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat.plot</span><span class="op">$</span><span class="va">lca</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat.plot</span><span class="op">$</span><span class="va">lca</span><span class="op">)</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Class '</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat.plot</span><span class="op">$</span><span class="va">lca</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span>
<span class="va">item.names</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">item.names</span>

<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">item.names</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="va">item.type</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ordinal'</span>, <span class="st">'Nominal'</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat.plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">lca</span>, x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">item.names</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, position<span class="op">=</span><span class="st">"dodge"</span>, stat<span class="op">=</span><span class="st">"count"</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Latent Classes'</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue2"</span>, <span class="st">"red2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                             
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Item Responses'</span>, y <span class="op">=</span> <span class="st">'Percentage'</span>, 
           title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item Name: '</span>, <span class="va">item.names</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, 
           subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item Type: '</span>, <span class="va">item.type</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, 
           caption <span class="op">=</span> <span class="st">'Note: Simulated data'</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span><span class="op">)</span>
    
  <span class="op">}</span><span class="co"># Ordinal</span>
  
  
  <span class="kw">if</span><span class="op">(</span><span class="va">item.type</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Poisson'</span>, <span class="st">'Neg_Binom'</span>, <span class="st">'ZINB'</span>, <span class="st">'ZIP'</span>, <span class="st">'Normal'</span>, <span class="st">'Beta'</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat.plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">item.names</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">lca</span>, fill <span class="op">=</span> <span class="va">lca</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Latent Classes'</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue2"</span>, <span class="st">"red2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Item Responses'</span>, y <span class="op">=</span> <span class="st">'Percentage'</span>, 
           title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item Name: '</span>, <span class="va">item.names</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, 
           subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item Type: '</span>, <span class="va">item.type</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, 
           caption <span class="op">=</span> <span class="st">'Note: Simulated data'</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span><span class="op">)</span>
    
  <span class="op">}</span><span class="co"># Count items</span>
  
  
  
<span class="op">}</span><span class="co"># end loop over items</span></code></pre></div>
<p><img src="Vig_1_files/figure-html/Plot%20Results-1.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-2.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-3.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-4.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-5.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-6.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-7.png" width="80%"><img src="Vig_1_files/figure-html/Plot%20Results-8.png" width="80%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlie Iaconangelo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
