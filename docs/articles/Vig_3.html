<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vignette_3 • CLCM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Vignette_3">
<meta property="og:description" content="CLCM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLCM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vig_1.html">Vignette_1</a>
    </li>
    <li>
      <a href="../articles/Vig_2.html">Vignette_2</a>
    </li>
    <li>
      <a href="../articles/Vig_3.html">Vignette_3</a>
    </li>
    <li>
      <a href="../articles/Vig_4.html">Vignette_4</a>
    </li>
    <li>
      <a href="../articles/Vig_5.html">Vignette_5</a>
    </li>
    <li>
      <a href="../articles/Vig_6.html">Vignette_6</a>
    </li>
    <li>
      <a href="../articles/Vig_7.html">Vignette_7</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Vig_3_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Vignette_3</h1>
            
      
      
      <div class="hidden name"><code>Vig_3.Rmd</code></div>

    </div>

    
    
<div id="vignette-3-clcm-with-more-than-2-latent-classes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignette-3-clcm-with-more-than-2-latent-classes" class="anchor"></a>Vignette 3: CLCM with More Than 2 Latent Classes</h2>
<ol style="list-style-type: decimal">
<li>Data generation with K=2 factors/atttributes, 2^K = 4 latent classes</li>
<li>Describe K, alpha, Q-matrix, eta</li>
<li>Correctly specified model fit, Misspecified model fit - compared via AIC/BIC</li>
</ol>
<p>This vignette illustrates slightly different data generation. specifically, we extend the data to two attributes/factors. This introduces additional complexity that should be addressed. This extension is the main focus. Second, we use only ordinal items, which allows us to demonstrate the use of the C2 fit statistic.</p>
</div>
<div id="specify-details-of-data-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#specify-details-of-data-generation" class="anchor"></a>Specify Details of Data Generation</h2>
<p>First load the CLCM package. Next, specify the data generation details. Here we generate 6 ordinal items, each with 4 categories (0, 1, 2, 3).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CLCM</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">number.timepoints</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">item.type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'Ordinal'</span>, <span class="fl">6</span><span class="op">)</span> 
<span class="va">categories.j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">item.type</span><span class="op">)</span>
<span class="va">item.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Item_'</span>, <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span></code></pre></div>
<div id="the-q-matrix-alpha-eta-and-condensation-rules---the-nitty-gritty" class="section level3">
<h3 class="hasAnchor">
<a href="#the-q-matrix-alpha-eta-and-condensation-rules---the-nitty-gritty" class="anchor"></a>The Q-matrix, <code>alpha</code>, <code>eta</code> and Condensation Rules - The Nitty Gritty</h3>
<p>Next, K is set to 2 to indicate 2 factors/attributes. The object <code>alpha</code> is the relationship between the latent classes and the attributes/factors.</p>
<p>Examine <code>alpha</code>:</p>
<pre><code>#&gt;                F1 F2
#&gt; Latent_Class_1  0  0
#&gt; Latent_Class_2  1  0
#&gt; Latent_Class_3  0  1
#&gt; Latent_Class_4  1  1</code></pre>
<p>The Q-matrix, which can be thought of as a factor-loading matrix, is a crucial part of the confirmatory latent class model. This pre-specified loading structure is what makes this a confirmatory approach. This Q-matrix contains 6 rows, 1 for each item, and 2 columns, 1 for each factor/attribute. Each items loads on only 1 factor. This is done for simplicity and to ensure the model is identified. There is an extensive literature on identifiability of CLCM. TODO: add citations</p>
<p>Examine the Q-matrix:</p>
<pre><code>#&gt;        F1 F2
#&gt; Item_1  1  0
#&gt; Item_2  1  0
#&gt; Item_3  1  0
#&gt; Item_4  0  1
#&gt; Item_5  0  1
#&gt; Item_6  0  1</code></pre>
<p>The <code>eta</code> object specifies the relationship between the latent classes, <code>alpha</code> and the Q-matrix, <code>Q</code>. This is referred to the literature as the Condensation Rule. Here the conjunctive item condensation rule is implemented. See the literature for more details.</p>
<p>Examine <code>eta</code>:</p>
<pre><code>#&gt;                Item_1 Item_2 Item_3 Item_4 Item_5 Item_6
#&gt; Latent_Class_1      0      0      0      0      0      0
#&gt; Latent_Class_2      1      1      1      0      0      0
#&gt; Latent_Class_3      0      0      0      1      1      1
#&gt; Latent_Class_4      1      1      1      1      1      1</code></pre>
<p>Broadly, the combination of the Q-matrix (and, when K&gt;1, the condensation rules), dramatically reduces the number of parameters required to be estimated. This of crucial importance, and should be highlighted: a sbustantial decrease in the number of parameters that are estimated is accomplished by the following:</p>
<ol style="list-style-type: decimal">
<li><p>Prespecifying which items load on which factors/attributes</p></li>
<li><p>Implementing the conjunctive condensation rule, where subjects are grouped into either Latent Class 0 or Latent Class 1 for each item.</p></li>
<li><p><code>eta</code> specifies this grouping - for example, looking at item 1, we can see that Latent classes 2 and 4 are set to 1, where as latent classes 0 and 3 are set to 0:</p></li>
</ol>
<pre><code>#&gt;                Item_1
#&gt; Latent_Class_1      0
#&gt; Latent_Class_2      1
#&gt; Latent_Class_3      0
#&gt; Latent_Class_4      1</code></pre>
<p>This means that, when estimating item <code>j</code>, the CLCM reduces the 2^K = 4 latent classes into 2.</p>
<p>Why latent classes 2 and 4? Well, refer back to the Q-matrix (<code>Q</code>) and <code>alpha</code>.</p>
<pre><code>#&gt;        F1 F2
#&gt; Item_1  1  0
#&gt;                F1 F2
#&gt; Latent_Class_1  0  0
#&gt; Latent_Class_2  1  0
#&gt; Latent_Class_3  0  1
#&gt; Latent_Class_4  1  1</code></pre>
<p>We can see that the first row of the Q-matrix indicates that the first item evaluates attribute/factor 1. Referring to the <code>alpha</code> matrix, we can see that latent classes 2 and 4 are a 1 on attribute/factor 1. Thus, latent classes 2 and 4 are grouped together for any item evaluating attribute/factor 1 by itself.</p>
</div>
<div id="latent-class-proportions" class="section level3">
<h3 class="hasAnchor">
<a href="#latent-class-proportions" class="anchor"></a>Latent Class Proportions</h3>
<p>The final part to specify are the latent class proportions <code>lc.prop</code> at the first (and only) timepoint. This is a uniform distribution, where the subjects are distributed equally throughout the latent classes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lc.prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Time_1'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">^</span><span class="va">K</span>, <span class="fl">2</span><span class="op">^</span><span class="va">K</span><span class="op">)</span><span class="op">)</span> 
<span class="va">lc.prop</span>
<span class="co">#&gt; $Time_1</span>
<span class="co">#&gt; [1] 0.25 0.25 0.25 0.25</span></code></pre></div>
</div>
</div>
<div id="simulate-item-responses" class="section level2">
<h2 class="hasAnchor">
<a href="#simulate-item-responses" class="anchor"></a>Simulate Item Responses</h2>
<p>The next step is to simulate data and briefly examine the item responses and posterior distributions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">03062021</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_clcm.html">simulate_clcm</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, Q <span class="op">=</span> <span class="va">Q</span>, number.timepoints <span class="op">=</span> <span class="va">number.timepoints</span>, 
                   item.type <span class="op">=</span> <span class="va">item.type</span>, 
                   categories.j <span class="op">=</span> <span class="va">categories.j</span>, 
                   lc.prop <span class="op">=</span> <span class="va">lc.prop</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">item.responses</span>, <span class="fl">2</span>, <span class="va">table</span><span class="op">)</span>                
<span class="co">#&gt;   Item_1 Item_2 Item_3 Item_4 Item_5 Item_6</span>
<span class="co">#&gt; 0     21     36     32     35     39     38</span>
<span class="co">#&gt; 1     53     46     47     43     45     35</span>
<span class="co">#&gt; 2     67     53     66     68     58     60</span>
<span class="co">#&gt; 3     59     65     55     54     58     67</span>
<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">item.responses</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>                
<span class="co">#&gt;   Item_1 Item_2 Item_3 Item_4 Item_5 Item_6</span>
<span class="co">#&gt; 0  0.105  0.180  0.160  0.175  0.195  0.190</span>
<span class="co">#&gt; 1  0.265  0.230  0.235  0.215  0.225  0.175</span>
<span class="co">#&gt; 2  0.335  0.265  0.330  0.340  0.290  0.300</span>
<span class="co">#&gt; 3  0.295  0.325  0.275  0.270  0.290  0.335</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">post</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     1     2     3     4 </span>
<span class="co">#&gt; 0.235 0.285 0.210 0.270</span></code></pre></div>
<p>Alright, we are all set to fit the CLCM to the data. We pass the dataframe containing the item responses, the item types, and the item names. Importantly, we also pass the Q-matrix, which specifies the relationship between the items and the attributes/factors. This implicitly also specifies the number of factors!</p>
</div>
<div id="estimate-clcm" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-clcm" class="anchor"></a>Estimate CLCM</h2>
<p>Next step is to estimate the model. Note the option <code>verbose = F</code> can be used to stop the function from printing estimation progress.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clcm.html">clcm</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">dat</span>, max.diff <span class="op">=</span> <span class="fl">0.001</span>,
             item.type <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">item.type</span>, 
             item.names <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">item.names</span>, 
             Q <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span> 
<span class="co">#&gt; iteration:  1   max diff in item parameter estimates:  1.697956 </span>
<span class="co">#&gt; iteration:  2   max diff in item parameter estimates:  0.231256 </span>
<span class="co">#&gt; iteration:  3   max diff in item parameter estimates:  0.158072 </span>
<span class="co">#&gt; iteration:  4   max diff in item parameter estimates:  0.106419 </span>
<span class="co">#&gt; iteration:  5   max diff in item parameter estimates:  0.077773 </span>
<span class="co">#&gt; iteration:  6   max diff in item parameter estimates:  0.062811 </span>
<span class="co">#&gt; iteration:  7   max diff in item parameter estimates:  0.052859 </span>
<span class="co">#&gt; iteration:  8   max diff in item parameter estimates:  0.045653 </span>
<span class="co">#&gt; iteration:  9   max diff in item parameter estimates:  0.039968 </span>
<span class="co">#&gt; iteration:  10   max diff in item parameter estimates:  0.035197 </span>
<span class="co">#&gt; iteration:  11   max diff in item parameter estimates:  0.031045 </span>
<span class="co">#&gt; iteration:  12   max diff in item parameter estimates:  0.027366 </span>
<span class="co">#&gt; iteration:  13   max diff in item parameter estimates:  0.024085 </span>
<span class="co">#&gt; iteration:  14   max diff in item parameter estimates:  0.021156 </span>
<span class="co">#&gt; iteration:  15   max diff in item parameter estimates:  0.018548 </span>
<span class="co">#&gt; iteration:  16   max diff in item parameter estimates:  0.016233 </span>
<span class="co">#&gt; iteration:  17   max diff in item parameter estimates:  0.014185 </span>
<span class="co">#&gt; iteration:  18   max diff in item parameter estimates:  0.012468 </span>
<span class="co">#&gt; iteration:  19   max diff in item parameter estimates:  0.01117 </span>
<span class="co">#&gt; iteration:  20   max diff in item parameter estimates:  0.009996 </span>
<span class="co">#&gt; iteration:  21   max diff in item parameter estimates:  0.008938 </span>
<span class="co">#&gt; iteration:  22   max diff in item parameter estimates:  0.007988 </span>
<span class="co">#&gt; iteration:  23   max diff in item parameter estimates:  0.007137 </span>
<span class="co">#&gt; iteration:  24   max diff in item parameter estimates:  0.006375 </span>
<span class="co">#&gt; iteration:  25   max diff in item parameter estimates:  0.005694 </span>
<span class="co">#&gt; iteration:  26   max diff in item parameter estimates:  0.005087 </span>
<span class="co">#&gt; iteration:  27   max diff in item parameter estimates:  0.005076 </span>
<span class="co">#&gt; iteration:  28   max diff in item parameter estimates:  0.00451 </span>
<span class="co">#&gt; iteration:  29   max diff in item parameter estimates:  0.004062 </span>
<span class="co">#&gt; iteration:  30   max diff in item parameter estimates:  0.003242 </span>
<span class="co">#&gt; iteration:  31   max diff in item parameter estimates:  0.002847 </span>
<span class="co">#&gt; iteration:  32   max diff in item parameter estimates:  0.003364 </span>
<span class="co">#&gt; iteration:  33   max diff in item parameter estimates:  0.002656 </span>
<span class="co">#&gt; iteration:  34   max diff in item parameter estimates:  0.00283 </span>
<span class="co">#&gt; iteration:  35   max diff in item parameter estimates:  0.001887 </span>
<span class="co">#&gt; iteration:  36   max diff in item parameter estimates:  0.002293 </span>
<span class="co">#&gt; iteration:  37   max diff in item parameter estimates:  0.002202 </span>
<span class="co">#&gt; iteration:  38   max diff in item parameter estimates:  0.001651 </span>
<span class="co">#&gt; iteration:  39   max diff in item parameter estimates:  0.001949 </span>
<span class="co">#&gt; iteration:  40   max diff in item parameter estimates:  0.002198 </span>
<span class="co">#&gt; iteration:  41   max diff in item parameter estimates:  0.001291 </span>
<span class="co">#&gt; iteration:  42   max diff in item parameter estimates:  0.002152 </span>
<span class="co">#&gt; iteration:  43   max diff in item parameter estimates:  0.000693</span></code></pre></div>
<p>For comparison, let’s also fit a misspecified model with only 2 latent classes instead of 4. First we specify the Q-matrix, which is just a single column of ones, and then we fit the model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">J</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clcm.html">clcm</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">dat</span>, max.diff <span class="op">=</span> <span class="fl">0.001</span>,
             item.type <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">item.type</span>, 
             item.names <span class="op">=</span> <span class="va">X</span><span class="op">$</span><span class="va">item.names</span>, 
             Q <span class="op">=</span> <span class="va">Q_2</span><span class="op">)</span> 
<span class="co">#&gt; iteration:  1   max diff in item parameter estimates:  1.808699 </span>
<span class="co">#&gt; iteration:  2   max diff in item parameter estimates:  0.213192 </span>
<span class="co">#&gt; iteration:  3   max diff in item parameter estimates:  0.13506 </span>
<span class="co">#&gt; iteration:  4   max diff in item parameter estimates:  0.127485 </span>
<span class="co">#&gt; iteration:  5   max diff in item parameter estimates:  0.140938 </span>
<span class="co">#&gt; iteration:  6   max diff in item parameter estimates:  0.139188 </span>
<span class="co">#&gt; iteration:  7   max diff in item parameter estimates:  0.133497 </span>
<span class="co">#&gt; iteration:  8   max diff in item parameter estimates:  0.118784 </span>
<span class="co">#&gt; iteration:  9   max diff in item parameter estimates:  0.100016 </span>
<span class="co">#&gt; iteration:  10   max diff in item parameter estimates:  0.081611 </span>
<span class="co">#&gt; iteration:  11   max diff in item parameter estimates:  0.065912 </span>
<span class="co">#&gt; iteration:  12   max diff in item parameter estimates:  0.053485 </span>
<span class="co">#&gt; iteration:  13   max diff in item parameter estimates:  0.043981 </span>
<span class="co">#&gt; iteration:  14   max diff in item parameter estimates:  0.036764 </span>
<span class="co">#&gt; iteration:  15   max diff in item parameter estimates:  0.031894 </span>
<span class="co">#&gt; iteration:  16   max diff in item parameter estimates:  0.030385 </span>
<span class="co">#&gt; iteration:  17   max diff in item parameter estimates:  0.028981 </span>
<span class="co">#&gt; iteration:  18   max diff in item parameter estimates:  0.027584 </span>
<span class="co">#&gt; iteration:  19   max diff in item parameter estimates:  0.026161 </span>
<span class="co">#&gt; iteration:  20   max diff in item parameter estimates:  0.024728 </span>
<span class="co">#&gt; iteration:  21   max diff in item parameter estimates:  0.023303 </span>
<span class="co">#&gt; iteration:  22   max diff in item parameter estimates:  0.021836 </span>
<span class="co">#&gt; iteration:  23   max diff in item parameter estimates:  0.020443 </span>
<span class="co">#&gt; iteration:  24   max diff in item parameter estimates:  0.019166 </span>
<span class="co">#&gt; iteration:  25   max diff in item parameter estimates:  0.018129 </span>
<span class="co">#&gt; iteration:  26   max diff in item parameter estimates:  0.017103 </span>
<span class="co">#&gt; iteration:  27   max diff in item parameter estimates:  0.016097 </span>
<span class="co">#&gt; iteration:  28   max diff in item parameter estimates:  0.015041 </span>
<span class="co">#&gt; iteration:  29   max diff in item parameter estimates:  0.014166 </span>
<span class="co">#&gt; iteration:  30   max diff in item parameter estimates:  0.013194 </span>
<span class="co">#&gt; iteration:  31   max diff in item parameter estimates:  0.012391 </span>
<span class="co">#&gt; iteration:  32   max diff in item parameter estimates:  0.011476 </span>
<span class="co">#&gt; iteration:  33   max diff in item parameter estimates:  0.010816 </span>
<span class="co">#&gt; iteration:  34   max diff in item parameter estimates:  0.009972 </span>
<span class="co">#&gt; iteration:  35   max diff in item parameter estimates:  0.010168 </span>
<span class="co">#&gt; iteration:  36   max diff in item parameter estimates:  0.008686 </span>
<span class="co">#&gt; iteration:  37   max diff in item parameter estimates:  0.008045 </span>
<span class="co">#&gt; iteration:  38   max diff in item parameter estimates:  0.007397 </span>
<span class="co">#&gt; iteration:  39   max diff in item parameter estimates:  0.006783 </span>
<span class="co">#&gt; iteration:  40   max diff in item parameter estimates:  0.006231 </span>
<span class="co">#&gt; iteration:  41   max diff in item parameter estimates:  0.005854 </span>
<span class="co">#&gt; iteration:  42   max diff in item parameter estimates:  0.005487 </span>
<span class="co">#&gt; iteration:  43   max diff in item parameter estimates:  0.005026 </span>
<span class="co">#&gt; iteration:  44   max diff in item parameter estimates:  0.004748 </span>
<span class="co">#&gt; iteration:  45   max diff in item parameter estimates:  0.004309 </span>
<span class="co">#&gt; iteration:  46   max diff in item parameter estimates:  0.003954 </span>
<span class="co">#&gt; iteration:  47   max diff in item parameter estimates:  0.002569 </span>
<span class="co">#&gt; iteration:  48   max diff in item parameter estimates:  0.00445 </span>
<span class="co">#&gt; iteration:  49   max diff in item parameter estimates:  0.00335 </span>
<span class="co">#&gt; iteration:  50   max diff in item parameter estimates:  0.002992 </span>
<span class="co">#&gt; iteration:  51   max diff in item parameter estimates:  0.002795 </span>
<span class="co">#&gt; iteration:  52   max diff in item parameter estimates:  0.002886 </span>
<span class="co">#&gt; iteration:  53   max diff in item parameter estimates:  0.003143 </span>
<span class="co">#&gt; iteration:  54   max diff in item parameter estimates:  0.002364 </span>
<span class="co">#&gt; iteration:  55   max diff in item parameter estimates:  0.001516 </span>
<span class="co">#&gt; iteration:  56   max diff in item parameter estimates:  0.002517 </span>
<span class="co">#&gt; iteration:  57   max diff in item parameter estimates:  0.001988 </span>
<span class="co">#&gt; iteration:  58   max diff in item parameter estimates:  0.002135 </span>
<span class="co">#&gt; iteration:  59   max diff in item parameter estimates:  0.001712 </span>
<span class="co">#&gt; iteration:  60   max diff in item parameter estimates:  0.002093 </span>
<span class="co">#&gt; iteration:  61   max diff in item parameter estimates:  0.002439 </span>
<span class="co">#&gt; iteration:  62   max diff in item parameter estimates:  0.001331 </span>
<span class="co">#&gt; iteration:  63   max diff in item parameter estimates:  0.001809 </span>
<span class="co">#&gt; iteration:  64   max diff in item parameter estimates:  0.001435 </span>
<span class="co">#&gt; iteration:  65   max diff in item parameter estimates:  0.001342 </span>
<span class="co">#&gt; iteration:  66   max diff in item parameter estimates:  0.001061 </span>
<span class="co">#&gt; iteration:  67   max diff in item parameter estimates:  0.001899 </span>
<span class="co">#&gt; iteration:  68   max diff in item parameter estimates:  0.000673</span></code></pre></div>
</div>
<div id="model-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fit" class="anchor"></a>Model Fit</h2>
<div id="absolute-fit-statistic" class="section level3">
<h3 class="hasAnchor">
<a href="#absolute-fit-statistic" class="anchor"></a>Absolute Fit Statistic</h3>
<p>First, compute the absolute fit statistic, C2. Note that this is slow - not run in this vignette.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/C2_clcm.html">C2_clcm</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> 
<span class="va">mod.fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/C2_clcm.html">C2_clcm</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span> </code></pre></div>
<p>Ideally we would see the C2 statistic reject the second model, but that does not happen here. Looks like this will require additional analysis. See the C2 vignette for more on the C2 statistic.</p>
</div>
<div id="relative-fit-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-fit-statistics" class="anchor"></a>Relative Fit Statistics</h3>
<p>Second, compute the relative fit statistics, AIC &amp; BIC:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">mod.fit.rel.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aic_bic_clcm.html">aic_bic_clcm</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
    <span class="va">mod.fit.rel.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aic_bic_clcm.html">aic_bic_clcm</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">mod.fit.rel.1</span><span class="op">)</span>
<span class="co">#&gt;  neg_2LL     npar      AIC      BIC </span>
<span class="co">#&gt; 3175.487   27.000 3229.487 3318.542</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">mod.fit.rel.2</span><span class="op">)</span>
<span class="co">#&gt;  neg_2LL     npar      AIC      BIC </span>
<span class="co">#&gt; 3204.254   25.000 3254.254 3336.712</span></code></pre></div>
<p>As we would expect, the incorrectly specified model ( <code>mod2</code>) has the larger AIC and BIC values.</p>
</div>
</div>
<div id="classification-accuracy" class="section level2">
<h2 class="hasAnchor">
<a href="#classification-accuracy" class="anchor"></a>Classification Accuracy</h2>
<p>Finally, use the correctly specified model (<code>mod1</code>) and compare the true classifications with estimates:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">      <span class="va">lca.hat</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">dat</span><span class="op">$</span><span class="va">lca</span> 
      <span class="va">lca.true</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">dat</span><span class="op">$</span><span class="va">true_lca</span>      
      <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">lca.true</span> <span class="op">==</span> <span class="va">lca.hat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;    75   125</span>
      <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">lca.true</span> <span class="op">==</span> <span class="va">lca.hat</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt; 0.375 0.625</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">lca.true</span> <span class="op">+</span> <span class="va">lca.hat</span><span class="op">)</span>
<span class="co">#&gt;         lca.hat</span>
<span class="co">#&gt; lca.true  1  2  3  4</span>
<span class="co">#&gt;        1 17  8 17  5</span>
<span class="co">#&gt;        2  0 38  1 18</span>
<span class="co">#&gt;        3  1  0 30 11</span>
<span class="co">#&gt;        4  0  4 10 40</span></code></pre></div>
<p>We can see that the classification accuracy tends to decrease as additional latent classes are added. This makes sense, given that the probability of randomly assigning a subject to the correct latent class decreases as the number of classes increases.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlie Iaconangelo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
